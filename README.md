# üîä Keyword Spotting: Stones Detector

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–æ—Å—Ç—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ **"stones"** –≤ –∞—É–¥–∏–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **PyTorch** –∏ **Torchaudio**. –ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞ —Å –ø–æ–º–æ—â—å—é **—Å–∫–æ–ª—å–∑—è—â–µ–≥–æ –æ–∫–Ω–∞** –∏ **–º–µ–ª-—Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º**.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ stones/         # WAV-—Ñ–∞–π–ª—ã —Å –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ not_stones/     # WAV-—Ñ–∞–π–ª—ã –±–µ–∑ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞
‚îÇ   ‚îî‚îÄ‚îÄ input/          # –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
‚îú‚îÄ‚îÄ detected_stones/    # –°–æ—Ö—Ä–∞–Ω—è–µ–º—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã –ø–æ—Å–ª–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
‚îú‚îÄ‚îÄ online_detected_stones/  # –°–µ–≥–º–µ–Ω—Ç—ã, –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –≤ —Ä–∞–¥–∏–æ—ç—Ñ–∏—Ä–µ
‚îú‚îÄ‚îÄ model.py            # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ CNN
‚îú‚îÄ‚îÄ dataset.py          # –ö–∞—Å—Ç–æ–º–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è/–≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ sliding_predict.py  # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ –∞—É–¥–∏–æ—Ñ–∞–π–ª—É
‚îú‚îÄ‚îÄ search_in_broadcast.py # –û–Ω–ª–∞–π–Ω –¥–µ—Ç–µ–∫—Ç–æ—Ä –ø–æ —Ä–∞–¥–∏–æ–ø–æ—Ç–æ–∫—É
‚îú‚îÄ‚îÄ model.pth           # –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îî‚îÄ‚îÄ README.md           # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Python 3.8+
- torch
- torchaudio
- numpy
- requests
- pydub

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
pip install torch torchaudio numpy requests pydub
```

---

## üßê –û–±—É—á–µ–Ω–∏–µ –∏ –¥–∞–Ω–Ω—ã–µ

–î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:

```
data/
‚îú‚îÄ‚îÄ stones/
‚îÇ   ‚îú‚îÄ‚îÄ stone1.wav
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ not_stones/
    ‚îú‚îÄ‚îÄ noise1.wav
    ‚îî‚îÄ‚îÄ ...
```

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `dataset.py`, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ –ø—Ä–µ–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏:

```python
from dataset import KeywordDataset

dataset = KeywordDataset("data/")
mel, label = dataset[0]
print(mel.shape)  # torch.Size([64, 81])
```

---

## ü•™ –ò–Ω—Ñ–µ—Ä–µ–Ω—Å: –ü–æ–∏—Å–∫ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞

–°–∫—Ä–∏–ø—Ç `sliding_predict.py` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —Å–ª–æ–≤–æ **"stones"** –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º –∞—É–¥–∏–æ—Ñ–∞–π–ª–µ:

```bash
python sliding_predict.py
```

–í–Ω—É—Ç—Ä–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∞–π–ª `data/input/thanos_message.wav`.

–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã —Å –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É `detected_stones/` –≤ –≤–∏–¥–µ `.wav` —Ñ–∞–π–ª–æ–≤.

–¢–∞–∫–∂–µ –≤–µ–¥—ë—Ç—Å—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å –∏ –≤ —Ñ–∞–π–ª `sliding_predict.log`.

---

## üìÉ –û–ø–∏—Å–∞–Ω–∏–µ `dataset.py`

–§–∞–π–ª `dataset.py` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª–∞—Å—Å `KeywordDataset`, –∫–æ—Ç–æ—Ä—ã–π:

- –ó–∞–≥—Ä—É–∂–∞–µ—Ç `.wav` —Ñ–∞–π–ª—ã –∏–∑ `stones/` –∏ `not_stones/`;
- –ü—Ä–∏–≤–æ–¥–∏—Ç –∞—É–¥–∏–æ –∫ –º–æ–Ω–æ –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω–µ (1 —Å–µ–∫—É–Ω–¥–∞);
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ –º–µ–ª-—Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—É —Å 64 –º–µ–ª-–∫–∞–Ω–∞–ª–∞–º–∏;
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–Ω–∑–æ—Ä —Ñ–æ—Ä–º—ã `[64, 81]` –∏ –º–µ—Ç–∫—É –∫–ª–∞—Å—Å–∞.

---

## üõ†Ô∏è –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–í—ã –º–æ–∂–µ—Ç–µ –æ–±—É—á–∏—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `CNNKeywordSpotter` –∏–∑ `model.py`. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `KeywordDataset` –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π DataLoader PyTorch.

---

## üì∞ –û–Ω–ª–∞–π–Ω –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤ —Ä–∞–¥–∏–æ—ç—Ñ–∏—Ä–µ (`search_in_broadcast.py`)

–°–∫—Ä–∏–ø—Ç `search_in_broadcast.py` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ **"stones"** –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ä–∞–¥–∏–æ–ø–æ—Ç–æ–∫–µ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Ç–æ–∫–æ–≤–æ–µ MP3-–∞—É–¥–∏–æ, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –æ–∫–Ω–∞, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –º–µ–ª-—Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—ã –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

### üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

- `` ‚Äî –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Ä–∞–¥–∏–æ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∞—É–¥–∏–æ –≤ –±—É—Ñ–µ—Ä.
- `` ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –±—É—Ñ–µ—Ä –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ `AudioSegment`, —Ö—Ä–∞–Ω—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–µ–∫—É–Ω–¥.
- `` ‚Äî –∫–∞–∂–¥—ã–µ 0.5 —Å–µ–∫. –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ "stones" –∏, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–≤—É–∫–æ–≤–æ–π —Å–µ–≥–º–µ–Ω—Ç.
- `` ‚Äî –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –≤ –Ω–∞—á–∞–ª–µ.
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –≤–µ–¥—ë—Ç—Å—è –≤ `logs/logs.log`.

### ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫:

```bash
python search_in_broadcast.py
```

### üìÇ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

–í—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É `online_detected_stones/` –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.wav`.

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –ø–æ–¥ —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏.

